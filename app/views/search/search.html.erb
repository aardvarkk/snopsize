<%# show a search form always %>
<%= form_tag("/search", :method => "get") do %>
  <%= label_tag(:q, "Search for:") %>
  <%= select_tag(:type, options_for_select([['Keyword', 'keyword'], ['URL', 'url'], ['User', 'user']], params[:type])) %>
  <%= text_field_tag(:q) %>
  <%# set the name to 'nil' to avoid the commit = Search parameter from being passed %>
  <%= submit_tag("Search", :name => nil) %>
<% end %></br>

<%# show any keyword results... %>
<% if @results %>
	<% case params[:type] %>
	<% when 'url' %>
	  <%= @results.size %> URL Results found</br></br>
    <%= link_to "Be the first to snop about " + @uri.to_s, new_snop_path(uri: @uri) %>
	<% when 'user' %>
	  <%= @results.size %> User Results found</br></br>
	  <%= render :partial => 'shared/userquick', :collection => @results %>
	<% else %>
	 	<%= @results.size %> Keyword Results found</br></br>

    <script>
    $(document).ready(reloadSnopsTable)

    function reloadSnopsTable()
    {
      $('#snops').dataTable( {
        "bFilter": false, 
        "bJQueryUI": true,
        "aaSorting": [],
        "bProcessing": true,
        "bServerSide": true,
        "sAjaxSource": $("#snops").data("source")
        });
    }
    </script>

    <div id="snops_view">
      <%= render partial: 'shared/snop_list_view', locals: {snops: @results, show_category: false} %>
    </div>
	<% end %>
<% end %>

<%#= debug params %>